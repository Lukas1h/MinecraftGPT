{"version":3,"sources":["main.ts"],"names":[],"mappings":"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","file":"../cotta/scripts/main.js","sourcesContent":["import { SimulatedPlayer, Test, register } from \"mojang-gametest\";\nimport {\n  world,\n  BlockLocation,\n  MinecraftBlockTypes,\n  Player,\n  Location,\n  BeforeChatEvent,\n  Entity,\n  Block,\n} from \"mojang-minecraft\";\nimport { TimedQueue } from \"./TimedQueue.js\";\nimport Utilities from \"./Utilities.js\";\n\nconst START_TICK = 100;\n\n// global variables\nlet curTick = 0;\nlet overworld = world.getDimension(\"overworld\");\nlet taskStack: TimedQueue = new TimedQueue();\nlet bot: Bot;\n\nclass Bot {\n  name: string;\n  test: Test;\n  isBotSpawned = false;\n  player: Player;\n  sim: SimulatedPlayer;\n  action: number;\n\n  evaluate(code: string, args = {}) {\n    return function evaluateEval() {\n      const argsStr = Object.keys(args)\n        .map((key) => `${key} = this.${key}`)\n        .join(\",\");\n      const argsDef = argsStr ? `let ${argsStr};` : \"\";\n\n      return eval(`(async () => {${argsDef}${code}})();`);\n    }.call(args);\n  }\n\n  goToEntity(player: Player) {\n    this.sim.runCommand(\"say Going to \" + player.name);\n\n    this.action = taskStack.setInterval(() => {\n      if (player.location.isNear(this.sim.location, 3)) {\n        this.sim.runCommand(\"say Near \" + player.name + \". Stoping.\");\n        taskStack.clearInterval(this.action);\n      } else {\n        this.sim.runCommand(\"say Still going to \" + player.name);\n        this.sim.navigateToLocation(this.test.relativeLocation(player.location));\n      }\n    }, 100);\n  }\n\n  goToLoc(loc: Location) {\n    this.sim.runCommand(\"say Going to \" + loc);\n    this.action = taskStack.setInterval(() => {\n      if (loc.isNear(this.sim.location, 3)) {\n        this.sim.runCommand(\"say Near \" + loc + \". Stoping.\");\n        taskStack.clearInterval(this.action);\n      } else {\n        this.sim.runCommand(\"say Still going to \" + loc);\n        this.sim.navigateToLocation(this.test.relativeLocation(loc));\n      }\n    }, 100);\n  }\n\n  followEntity(player: Player) {\n    this.sim.runCommand(\"say Going to \" + player.name);\n\n    this.action = taskStack.setInterval(() => {\n      if (player.location.isNear(this.sim.location, 3)) {\n        this.sim.runCommand(\"say Near \" + player.name + \". Stoping.\");\n      } else {\n        this.sim.runCommand(\"say Still going to \" + player.name);\n        this.sim.navigateToLocation(this.test.relativeLocation(player.location));\n      }\n    }, 100);\n  }\n\n  constructor(name: string, test: Test) {\n    this.action = 0;\n    this.name = name;\n    this.sim = test.spawnSimulatedPlayer(new BlockLocation(1, 0, 1), this.name, 0);\n    this.player = Array.from(world.getPlayers())[0];\n    this.test = test;\n    this.sim.runCommand(\"say Sim Init'ed \");\n\n    taskStack.setInterval(() => {\n      this.sim.lookAtLocation(this.test.relativeLocation(this.player.headLocation));\n    }, 100);\n  }\n}\n\nregister(\"friend\", \"spawn\", (test) => {\n  bot = new Bot(\"Robo Steve\", test);\n  bot.goToEntity(bot.player);\n}).maxTicks(72000);\n\nfunction gameTick() {\n  curTick++;\n  taskStack.processTick();\n}\n\nconst propts = {\n  move: [\"come\", \"stand\", \"stay here\"],\n  go: [\"go\"],\n  follow: [\"follow\", \"stay with me\", \"come with\"],\n  jump: [\"jump\", \"hop\", \"dance\"],\n  cmd: [\"cmd \"],\n  eval: [\"eval \"],\n  stop: [\"halt\", \"stop\", \"stay\", \"sit\", \"stand here\", \"stand there\"],\n};\n\nworld.events.beforeChat.subscribe((chat: BeforeChatEvent) => {\n  let msg = chat.message.replace(\"the\", \"\").replace(\"a\", \"\").replace(\"an\", \"\");\n  let verb = msg.split(\" \")[0];\n  let obj = msg.split(\" \")[0];\n\n  if (propts[\"move\"].some((v) => msg.includes(v))) {\n    bot.goToEntity(bot.player);\n  }\n  if (propts[\"go\"].some((v) => msg.includes(v))) {\n    bot.goToLoc(blockToLoc(bot.player.getBlockFromViewVector().location));\n  }\n  if (propts[\"follow\"].some((v) => msg.includes(v))) {\n    bot.followEntity(bot.player);\n  }\n  if (propts[\"jump\"].some((v) => msg.includes(v))) {\n    bot.sim.jump();\n  }\n  if (propts[\"cmd\"].some((v) => msg.includes(v))) {\n    bot.sim.runCommand(msg.replace(\"cmd \", \"\"));\n  }\n\n  if (propts[\"eval\"].some((v) => msg.includes(v))) {\n    bot.evaluate(msg.replace(\"eval \", \"\"), {\n      setTimeout: taskStack.setTimeout.bind(taskStack),\n      sleep: taskStack.sleep.bind(taskStack),\n      clearTimeout: taskStack.clearTimeout.bind(taskStack),\n      setInterval: taskStack.setInterval.bind(taskStack),\n      clearInterval: taskStack.clearInterval.bind(taskStack),\n      bot: bot,\n      overworld: overworld,\n    });\n  }\n  if (propts[\"stop\"].some((v) => msg.includes(v))) {\n    taskStack.clearInterval(bot.action);\n  }\n});\n\nfunction blockToLoc(block: BlockLocation) {\n  return new Location(block.x, block.y, block.z);\n}\nfunction locToBLock(block: Location) {\n  return new BlockLocation(block.x, block.y, block.z);\n}\n\nworld.events.tick.subscribe(gameTick);\n"],"sourceRoot":"../scripts"}